{
  "configuration" : {
    "scope" : "SoftwareSystem"
  },
  "description" : "C4 architecture model for the webinar registration system deployed on Azure IaaS",
  "documentation" : { },
  "id" : 1,
  "lastModifiedDate" : "2025-12-15T17:01:39Z",
  "model" : {
    "deploymentNodes" : [ {
      "children" : [ {
        "containerInstances" : [ {
          "containerId" : "5",
          "deploymentGroups" : [ "Default" ],
          "environment" : "Production",
          "id" : "45",
          "instanceId" : 1,
          "properties" : {
            "structurizr.dsl.identifier" : "production.b0ce247d-e524-4777-a64d-39a114d3f754.c2efbed4-3554-46bc-83b3-adab5c7931ad.browserInstance"
          },
          "relationships" : [ {
            "description" : "HTTPS requests",
            "destinationId" : "58",
            "id" : "60",
            "linkedRelationshipId" : "24",
            "sourceId" : "45",
            "technology" : "HTTPS/443"
          } ],
          "tags" : "Container Instance"
        } ],
        "description" : "User's web browser for accessing the application",
        "environment" : "Production",
        "id" : "44",
        "instances" : "1",
        "name" : "Web Browser",
        "properties" : {
          "structurizr.dsl.identifier" : "production.b0ce247d-e524-4777-a64d-39a114d3f754.c2efbed4-3554-46bc-83b3-adab5c7931ad"
        },
        "tags" : "Element,Deployment Node",
        "technology" : "Chrome, Firefox, Safari"
      }, {
        "containerInstances" : [ {
          "containerId" : "6",
          "deploymentGroups" : [ "Default" ],
          "environment" : "Production",
          "id" : "47",
          "instanceId" : 1,
          "properties" : {
            "structurizr.dsl.identifier" : "production.b0ce247d-e524-4777-a64d-39a114d3f754.23817fec-a089-474a-8eb7-a6e54b1bd946.terminalInstance"
          },
          "relationships" : [ {
            "description" : "Connects to",
            "destinationId" : "53",
            "id" : "54",
            "linkedRelationshipId" : "25",
            "sourceId" : "47",
            "technology" : "Azure CLI, SSH"
          } ],
          "tags" : "Container Instance"
        } ],
        "description" : "Command-line interface for administrative tasks",
        "environment" : "Production",
        "id" : "46",
        "instances" : "1",
        "name" : "Terminal",
        "properties" : {
          "structurizr.dsl.identifier" : "production.b0ce247d-e524-4777-a64d-39a114d3f754.23817fec-a089-474a-8eb7-a6e54b1bd946"
        },
        "tags" : "Element,Deployment Node",
        "technology" : "Azure CLI, SSH"
      } ],
      "description" : "User's local machine",
      "environment" : "Production",
      "id" : "43",
      "instances" : "1",
      "name" : "User Environment",
      "properties" : {
        "structurizr.dsl.identifier" : "production.b0ce247d-e524-4777-a64d-39a114d3f754"
      },
      "tags" : "Element,Deployment Node",
      "technology" : "Desktop/Laptop"
    }, {
      "children" : [ {
        "children" : [ {
          "children" : [ {
            "containerInstances" : [ {
              "containerId" : "7",
              "deploymentGroups" : [ "Default" ],
              "environment" : "Production",
              "id" : "53",
              "instanceId" : 1,
              "properties" : {
                "structurizr.dsl.identifier" : "production.223ceced-ec8a-49bd-97ce-ae57f1fce6fc.56ec7659-8b2f-48c8-94a6-a91c6b8d393d.e1c6f399-f8c9-429d-a713-1e040e85aa3f.fe1ea7f5-e8da-42a6-b704-0d21c2a6174d.bastionInstance"
              },
              "relationships" : [ {
                "description" : "SSH",
                "destinationId" : "58",
                "id" : "61",
                "linkedRelationshipId" : "26",
                "sourceId" : "53",
                "technology" : "SSH/22"
              }, {
                "description" : "SSH",
                "destinationId" : "65",
                "id" : "67",
                "linkedRelationshipId" : "27",
                "sourceId" : "53",
                "technology" : "SSH/22"
              } ],
              "tags" : "Container Instance"
            } ],
            "description" : "SSH jump server for secure admin access",
            "environment" : "Production",
            "id" : "52",
            "instances" : "1",
            "name" : "Bastion Host",
            "properties" : {
              "structurizr.dsl.identifier" : "production.223ceced-ec8a-49bd-97ce-ae57f1fce6fc.56ec7659-8b2f-48c8-94a6-a91c6b8d393d.e1c6f399-f8c9-429d-a713-1e040e85aa3f.fe1ea7f5-e8da-42a6-b704-0d21c2a6174d"
            },
            "tags" : "Element,Deployment Node",
            "technology" : "Azure VM, Ubuntu 24.04 LTS, Standard_B1s"
          } ],
          "description" : "snet-bastion",
          "environment" : "Production",
          "id" : "50",
          "infrastructureNodes" : [ {
            "description" : "Allow SSH from Internet",
            "environment" : "Production",
            "id" : "51",
            "name" : "NSG Bastion",
            "properties" : {
              "structurizr.dsl.identifier" : "production.223ceced-ec8a-49bd-97ce-ae57f1fce6fc.56ec7659-8b2f-48c8-94a6-a91c6b8d393d.e1c6f399-f8c9-429d-a713-1e040e85aa3f.nsgBastion"
            },
            "tags" : "Element,Infrastructure Node,NSG",
            "technology" : "Azure NSG"
          } ],
          "instances" : "1",
          "name" : "Bastion Subnet",
          "properties" : {
            "structurizr.dsl.identifier" : "production.223ceced-ec8a-49bd-97ce-ae57f1fce6fc.56ec7659-8b2f-48c8-94a6-a91c6b8d393d.e1c6f399-f8c9-429d-a713-1e040e85aa3f"
          },
          "tags" : "Element,Deployment Node",
          "technology" : "10.0.1.0/24"
        }, {
          "children" : [ {
            "containerInstances" : [ {
              "containerId" : "8",
              "deploymentGroups" : [ "Default" ],
              "environment" : "Production",
              "id" : "58",
              "instanceId" : 1,
              "properties" : {
                "structurizr.dsl.identifier" : "production.223ceced-ec8a-49bd-97ce-ae57f1fce6fc.56ec7659-8b2f-48c8-94a6-a91c6b8d393d.ea64341f-19d7-4414-9fba-71c141bd1ef5.c8b006a0-f9b0-4227-9c37-dfcafa010282.proxyInstance"
              },
              "relationships" : [ {
                "description" : "301 Redirect to HTTPS",
                "destinationId" : "45",
                "id" : "59",
                "linkedRelationshipId" : "39",
                "sourceId" : "58",
                "technology" : "HTTP Response"
              }, {
                "description" : "Forwards requests",
                "destinationId" : "65",
                "id" : "68",
                "linkedRelationshipId" : "28",
                "sourceId" : "58",
                "technology" : "HTTP/5001"
              } ],
              "tags" : "Container Instance"
            } ],
            "description" : "nginx server for SSL termination",
            "environment" : "Production",
            "id" : "57",
            "instances" : "1",
            "name" : "Reverse Proxy",
            "properties" : {
              "structurizr.dsl.identifier" : "production.223ceced-ec8a-49bd-97ce-ae57f1fce6fc.56ec7659-8b2f-48c8-94a6-a91c6b8d393d.ea64341f-19d7-4414-9fba-71c141bd1ef5.c8b006a0-f9b0-4227-9c37-dfcafa010282"
            },
            "tags" : "Element,Deployment Node",
            "technology" : "Azure VM, Ubuntu 24.04 LTS, Standard_B1s"
          } ],
          "description" : "snet-web",
          "environment" : "Production",
          "id" : "55",
          "infrastructureNodes" : [ {
            "description" : "Allow HTTP/HTTPS from Internet",
            "environment" : "Production",
            "id" : "56",
            "name" : "NSG Web",
            "properties" : {
              "structurizr.dsl.identifier" : "production.223ceced-ec8a-49bd-97ce-ae57f1fce6fc.56ec7659-8b2f-48c8-94a6-a91c6b8d393d.ea64341f-19d7-4414-9fba-71c141bd1ef5.nsgWeb"
            },
            "tags" : "Element,Infrastructure Node,NSG",
            "technology" : "Azure NSG"
          } ],
          "instances" : "1",
          "name" : "Web Subnet",
          "properties" : {
            "structurizr.dsl.identifier" : "production.223ceced-ec8a-49bd-97ce-ae57f1fce6fc.56ec7659-8b2f-48c8-94a6-a91c6b8d393d.ea64341f-19d7-4414-9fba-71c141bd1ef5"
          },
          "tags" : "Element,Deployment Node",
          "technology" : "10.0.2.0/24"
        }, {
          "children" : [ {
            "containerInstances" : [ {
              "containerId" : "12",
              "deploymentGroups" : [ "Default" ],
              "environment" : "Production",
              "id" : "65",
              "instanceId" : 1,
              "properties" : {
                "structurizr.dsl.identifier" : "production.223ceced-ec8a-49bd-97ce-ae57f1fce6fc.56ec7659-8b2f-48c8-94a6-a91c6b8d393d.a35d72bf-e3ac-4634-870a-1d64a698220b.c6e9c94d-a3a8-4385-96c7-dde5a65ac4de.flaskInstance"
              },
              "relationships" : [ {
                "description" : "Returns HTML",
                "destinationId" : "45",
                "id" : "66",
                "linkedRelationshipId" : "36",
                "sourceId" : "65",
                "technology" : "HTTP Response"
              }, {
                "description" : "Reads/writes data",
                "destinationId" : "72",
                "id" : "73",
                "linkedRelationshipId" : "29",
                "sourceId" : "65",
                "technology" : "PostgreSQL/5432"
              } ],
              "tags" : "Container Instance"
            } ],
            "description" : "Flask application with Gunicorn",
            "environment" : "Production",
            "id" : "64",
            "instances" : "1",
            "name" : "Application Server",
            "properties" : {
              "structurizr.dsl.identifier" : "production.223ceced-ec8a-49bd-97ce-ae57f1fce6fc.56ec7659-8b2f-48c8-94a6-a91c6b8d393d.a35d72bf-e3ac-4634-870a-1d64a698220b.c6e9c94d-a3a8-4385-96c7-dde5a65ac4de"
            },
            "tags" : "Element,Deployment Node",
            "technology" : "Azure VM, Ubuntu 24.04 LTS, Standard_B1s"
          } ],
          "description" : "snet-app",
          "environment" : "Production",
          "id" : "62",
          "infrastructureNodes" : [ {
            "description" : "Allow HTTP from Web Subnet",
            "environment" : "Production",
            "id" : "63",
            "name" : "NSG App",
            "properties" : {
              "structurizr.dsl.identifier" : "production.223ceced-ec8a-49bd-97ce-ae57f1fce6fc.56ec7659-8b2f-48c8-94a6-a91c6b8d393d.a35d72bf-e3ac-4634-870a-1d64a698220b.nsgApp"
            },
            "tags" : "Element,Infrastructure Node,NSG",
            "technology" : "Azure NSG"
          } ],
          "instances" : "1",
          "name" : "App Subnet",
          "properties" : {
            "structurizr.dsl.identifier" : "production.223ceced-ec8a-49bd-97ce-ae57f1fce6fc.56ec7659-8b2f-48c8-94a6-a91c6b8d393d.a35d72bf-e3ac-4634-870a-1d64a698220b"
          },
          "tags" : "Element,Deployment Node",
          "technology" : "10.0.3.0/24"
        }, {
          "children" : [ {
            "containerInstances" : [ {
              "containerId" : "17",
              "deploymentGroups" : [ "Default" ],
              "environment" : "Production",
              "id" : "72",
              "instanceId" : 1,
              "properties" : {
                "structurizr.dsl.identifier" : "production.223ceced-ec8a-49bd-97ce-ae57f1fce6fc.56ec7659-8b2f-48c8-94a6-a91c6b8d393d.00cf527e-12bf-4a52-897e-9536cdcc3431.59bad257-017d-4457-9094-7c98662e756a.databaseInstance"
              },
              "tags" : "Container Instance"
            } ],
            "description" : "psql-flask-bicep-dev",
            "environment" : "Production",
            "id" : "71",
            "instances" : "1",
            "name" : "Azure PostgreSQL Flexible Server",
            "properties" : {
              "structurizr.dsl.identifier" : "production.223ceced-ec8a-49bd-97ce-ae57f1fce6fc.56ec7659-8b2f-48c8-94a6-a91c6b8d393d.00cf527e-12bf-4a52-897e-9536cdcc3431.59bad257-017d-4457-9094-7c98662e756a"
            },
            "tags" : "Element,Deployment Node",
            "technology" : "Burstable B1ms"
          } ],
          "description" : "snet-data",
          "environment" : "Production",
          "id" : "69",
          "infrastructureNodes" : [ {
            "description" : "Allow PostgreSQL from App Subnet",
            "environment" : "Production",
            "id" : "70",
            "name" : "NSG Data",
            "properties" : {
              "structurizr.dsl.identifier" : "production.223ceced-ec8a-49bd-97ce-ae57f1fce6fc.56ec7659-8b2f-48c8-94a6-a91c6b8d393d.00cf527e-12bf-4a52-897e-9536cdcc3431.nsgData"
            },
            "tags" : "Element,Infrastructure Node,NSG",
            "technology" : "Azure NSG"
          } ],
          "instances" : "1",
          "name" : "Data Subnet",
          "properties" : {
            "structurizr.dsl.identifier" : "production.223ceced-ec8a-49bd-97ce-ae57f1fce6fc.56ec7659-8b2f-48c8-94a6-a91c6b8d393d.00cf527e-12bf-4a52-897e-9536cdcc3431"
          },
          "tags" : "Element,Deployment Node",
          "technology" : "10.0.4.0/24"
        } ],
        "description" : "vnet-flask-bicep-dev",
        "environment" : "Production",
        "id" : "49",
        "instances" : "1",
        "name" : "Virtual Network",
        "properties" : {
          "structurizr.dsl.identifier" : "production.223ceced-ec8a-49bd-97ce-ae57f1fce6fc.56ec7659-8b2f-48c8-94a6-a91c6b8d393d"
        },
        "tags" : "Element,Deployment Node",
        "technology" : "10.0.0.0/16"
      } ],
      "description" : "Microsoft Azure public cloud infrastructure",
      "environment" : "Production",
      "id" : "48",
      "instances" : "1",
      "name" : "Azure Cloud",
      "properties" : {
        "structurizr.dsl.identifier" : "production.223ceced-ec8a-49bd-97ce-ae57f1fce6fc"
      },
      "tags" : "Element,Deployment Node",
      "technology" : "Azure IaaS"
    } ],
    "people" : [ {
      "description" : "Primary actor - registers for and attends webinars",
      "id" : "1",
      "name" : "Event Attendee",
      "perspectives" : [ {
        "description" : "Main customer touchpoint, drives webinar attendance",
        "name" : "Business"
      }, {
        "description" : "External user, requires input validation",
        "name" : "Security"
      } ],
      "properties" : {
        "structurizr.dsl.identifier" : "attendee",
        "Trust Level" : "External, untrusted",
        "Actor Type" : "Primary",
        "Frequency" : "High"
      },
      "relationships" : [ {
        "description" : "Registers for webinars",
        "destinationId" : "4",
        "id" : "18",
        "sourceId" : "1",
        "tags" : "Relationship",
        "technology" : "HTTPS"
      }, {
        "description" : "Uses",
        "destinationId" : "5",
        "id" : "21",
        "sourceId" : "1",
        "tags" : "Relationship",
        "technology" : "Mouse, keyboard"
      } ],
      "tags" : "Element,Person,Primary Actor"
    }, {
      "description" : "Supporting actor - manages webinars and views registrations",
      "id" : "2",
      "name" : "Marketing Admin",
      "perspectives" : [ {
        "description" : "Monitors registration success, plans capacity",
        "name" : "Business"
      }, {
        "description" : "Internal user, future: requires authentication",
        "name" : "Security"
      } ],
      "properties" : {
        "structurizr.dsl.identifier" : "admin",
        "Trust Level" : "Internal, trusted",
        "Actor Type" : "Secondary",
        "Frequency" : "Medium"
      },
      "relationships" : [ {
        "description" : "Views registrations",
        "destinationId" : "4",
        "id" : "19",
        "sourceId" : "2",
        "tags" : "Relationship",
        "technology" : "HTTPS"
      }, {
        "description" : "Uses",
        "destinationId" : "5",
        "id" : "22",
        "sourceId" : "2",
        "tags" : "Relationship",
        "technology" : "Mouse, keyboard"
      } ],
      "tags" : "Element,Person,Primary Actor"
    }, {
      "description" : "Supporting actor - deploys and maintains infrastructure",
      "id" : "3",
      "name" : "SysAdmin",
      "perspectives" : [ {
        "description" : "Ensures system availability and performance",
        "name" : "Business"
      }, {
        "description" : "Privileged access via SSH through bastion host",
        "name" : "Security"
      } ],
      "properties" : {
        "structurizr.dsl.identifier" : "sysadmin",
        "Trust Level" : "Internal, privileged",
        "Actor Type" : "Secondary",
        "Frequency" : "Low"
      },
      "relationships" : [ {
        "description" : "Deploys and maintains",
        "destinationId" : "4",
        "id" : "20",
        "sourceId" : "3",
        "tags" : "Relationship",
        "technology" : "SSH"
      }, {
        "description" : "Uses",
        "destinationId" : "6",
        "id" : "23",
        "sourceId" : "3",
        "tags" : "Relationship",
        "technology" : "Keyboard"
      } ],
      "tags" : "Element,Person,Secondary Actor"
    } ],
    "softwareSystems" : [ {
      "containers" : [ {
        "description" : "Renders HTML, JavaScript and CSS",
        "documentation" : { },
        "group" : "Front-end",
        "id" : "5",
        "name" : "Web Browser",
        "properties" : {
          "structurizr.dsl.identifier" : "webinarSystem.browser"
        },
        "relationships" : [ {
          "description" : "HTTPS requests",
          "destinationId" : "8",
          "id" : "24",
          "sourceId" : "5",
          "tags" : "Relationship",
          "technology" : "HTTPS/443"
        }, {
          "description" : "HTTP request",
          "destinationId" : "9",
          "id" : "37",
          "sourceId" : "5",
          "tags" : "Relationship,ComponentLevel",
          "technology" : "HTTP/80"
        }, {
          "description" : "HTTPS request",
          "destinationId" : "10",
          "id" : "40",
          "sourceId" : "5",
          "tags" : "Relationship,ComponentLevel",
          "technology" : "HTTPS/443"
        } ],
        "tags" : "Element,Container,Client,Primary Client",
        "technology" : "Chrome, Firefox, Safari"
      }, {
        "description" : "Command-line interface for administrative access",
        "documentation" : { },
        "group" : "Front-end",
        "id" : "6",
        "name" : "Terminal",
        "properties" : {
          "structurizr.dsl.identifier" : "webinarSystem.terminal"
        },
        "relationships" : [ {
          "description" : "Connects to",
          "destinationId" : "7",
          "id" : "25",
          "sourceId" : "6",
          "tags" : "Relationship",
          "technology" : "Azure CLI, SSH"
        } ],
        "tags" : "Element,Container,Client,Secondary Client",
        "technology" : "Azure CLI, SSH"
      }, {
        "description" : "Secure SSH entry point for administrative access",
        "documentation" : { },
        "group" : "Back-end",
        "id" : "7",
        "name" : "Bastion Host",
        "properties" : {
          "structurizr.dsl.identifier" : "webinarSystem.bastion"
        },
        "relationships" : [ {
          "description" : "SSH",
          "destinationId" : "8",
          "id" : "26",
          "sourceId" : "7",
          "tags" : "Relationship",
          "technology" : "SSH/22"
        }, {
          "description" : "SSH",
          "destinationId" : "12",
          "id" : "27",
          "sourceId" : "7",
          "tags" : "Relationship",
          "technology" : "SSH/22"
        } ],
        "tags" : "Element,Container,Bastion",
        "technology" : "Ubuntu 24.04, Fail2ban"
      }, {
        "components" : [ {
          "description" : "Redirects HTTP to HTTPS",
          "documentation" : { },
          "id" : "9",
          "name" : "HTTP Redirect Block",
          "properties" : {
            "structurizr.dsl.identifier" : "webinarSystem.proxy.httpRedirect"
          },
          "relationships" : [ {
            "description" : "301 Redirect to HTTPS",
            "destinationId" : "5",
            "id" : "38",
            "sourceId" : "9",
            "tags" : "Relationship,ComponentLevel",
            "technology" : "HTTP Response"
          } ],
          "tags" : "Element,Component",
          "technology" : "nginx server block port 80"
        }, {
          "description" : "SSL termination and request handling",
          "documentation" : { },
          "id" : "10",
          "name" : "HTTPS Server Block",
          "properties" : {
            "structurizr.dsl.identifier" : "webinarSystem.proxy.httpsServerBlock"
          },
          "relationships" : [ {
            "description" : "Uses",
            "destinationId" : "11",
            "id" : "41",
            "sourceId" : "10",
            "tags" : "Relationship",
            "technology" : "TLS"
          }, {
            "description" : "Forwards to backend",
            "destinationId" : "12",
            "id" : "42",
            "sourceId" : "10",
            "tags" : "Relationship",
            "technology" : "HTTP/5001"
          } ],
          "tags" : "Element,Component",
          "technology" : "nginx server block port 443"
        }, {
          "description" : "TLS/SSL certificate for encryption",
          "documentation" : { },
          "id" : "11",
          "name" : "SSL Certificate",
          "properties" : {
            "structurizr.dsl.identifier" : "webinarSystem.proxy.sslCertificate"
          },
          "tags" : "Element,Component",
          "technology" : "Self-signed (OpenSSL)"
        } ],
        "description" : "SSL offloading and request forwarding",
        "documentation" : { },
        "group" : "Back-end",
        "id" : "8",
        "name" : "Reverse Proxy",
        "properties" : {
          "structurizr.dsl.identifier" : "webinarSystem.proxy"
        },
        "relationships" : [ {
          "description" : "Forwards requests",
          "destinationId" : "12",
          "id" : "28",
          "sourceId" : "8",
          "tags" : "Relationship",
          "technology" : "HTTP/5001"
        }, {
          "description" : "HTTP requests",
          "destinationId" : "16",
          "id" : "30",
          "sourceId" : "8",
          "tags" : "Relationship",
          "technology" : "HTTP/5001"
        }, {
          "description" : "301 Redirect to HTTPS",
          "destinationId" : "5",
          "id" : "39",
          "linkedRelationshipId" : "38",
          "sourceId" : "8",
          "technology" : "HTTP Response"
        } ],
        "tags" : "Element,Container",
        "technology" : "nginx, OpenSSL"
      }, {
        "components" : [ {
          "description" : "HTTP request handling, form processing",
          "documentation" : { },
          "id" : "13",
          "name" : "Route Handlers",
          "properties" : {
            "structurizr.dsl.identifier" : "webinarSystem.flask.routes"
          },
          "relationships" : [ {
            "description" : "Renders HTML",
            "destinationId" : "14",
            "id" : "32",
            "sourceId" : "13",
            "tags" : "Relationship",
            "technology" : "Jinja2 API"
          }, {
            "description" : "CRUD operations",
            "destinationId" : "15",
            "id" : "33",
            "sourceId" : "13",
            "tags" : "Relationship",
            "technology" : "Python method calls"
          } ],
          "tags" : "Element,Component",
          "technology" : "Flask @app.route"
        }, {
          "description" : "HTML rendering with data binding",
          "documentation" : { },
          "id" : "14",
          "name" : "Template Engine",
          "properties" : {
            "structurizr.dsl.identifier" : "webinarSystem.flask.templates"
          },
          "relationships" : [ {
            "description" : "Returns HTML",
            "destinationId" : "5",
            "id" : "35",
            "sourceId" : "14",
            "tags" : "Relationship,FlaskComponent",
            "technology" : "HTTP Response"
          } ],
          "tags" : "Element,Component",
          "technology" : "Jinja2"
        }, {
          "description" : "Database abstraction, ORM",
          "documentation" : { },
          "id" : "15",
          "name" : "Data Models",
          "properties" : {
            "structurizr.dsl.identifier" : "webinarSystem.flask.models"
          },
          "relationships" : [ {
            "description" : "SQL queries",
            "destinationId" : "17",
            "id" : "34",
            "sourceId" : "15",
            "tags" : "Relationship",
            "technology" : "psycopg2"
          } ],
          "tags" : "Element,Component",
          "technology" : "SQLAlchemy"
        }, {
          "description" : "Production HTTP server, process management",
          "documentation" : { },
          "id" : "16",
          "name" : "WSGI Server",
          "properties" : {
            "structurizr.dsl.identifier" : "webinarSystem.flask.wsgi"
          },
          "relationships" : [ {
            "description" : "Forwards requests",
            "destinationId" : "13",
            "id" : "31",
            "sourceId" : "16",
            "tags" : "Relationship",
            "technology" : "WSGI"
          } ],
          "tags" : "Element,Component",
          "technology" : "Gunicorn"
        } ],
        "description" : "Handles registration logic, serves HTML",
        "documentation" : { },
        "group" : "Back-end",
        "id" : "12",
        "name" : "Flask Application",
        "properties" : {
          "structurizr.dsl.identifier" : "webinarSystem.flask"
        },
        "relationships" : [ {
          "description" : "Reads/writes data",
          "destinationId" : "17",
          "id" : "29",
          "sourceId" : "12",
          "tags" : "Relationship",
          "technology" : "PostgreSQL/5432"
        }, {
          "description" : "Returns HTML",
          "destinationId" : "5",
          "id" : "36",
          "linkedRelationshipId" : "35",
          "sourceId" : "12",
          "technology" : "HTTP Response"
        } ],
        "tags" : "Element,Container,Application",
        "technology" : "Python/Gunicorn"
      }, {
        "description" : "Stores registration data persistently",
        "documentation" : { },
        "group" : "Back-end",
        "id" : "17",
        "name" : "PostgreSQL Database",
        "properties" : {
          "structurizr.dsl.identifier" : "webinarSystem.database"
        },
        "tags" : "Element,Container,Database",
        "technology" : "Managed PostgreSQL"
      } ],
      "description" : "Allows attendees to register for webinars and administrators to manage events",
      "documentation" : {
        "decisions" : [ {
          "content" : "# 1. Use Pure IaaS Approach\n\nDate: 2025-12-15\n\n## Status\n\nAccepted\n\n## Context\n\nWe need to choose an infrastructure approach for hosting the webinar registration website on Azure.\n\nOptions considered:\n1. Pure IaaS (Virtual Machines)\n2. PaaS (App Service, Container Apps)\n3. Serverless (Functions)\n\n## Decision\n\nWe will use a pure IaaS approach with self-managed Ubuntu VMs for compute.\n\n## Consequences\n\n**Positive:**\n- Full control over the environment\n- Traditional Linux administration skills applicable\n- No vendor lock-in for compute layer\n- Educational value for understanding infrastructure fundamentals\n\n**Negative:**\n- More operational overhead (patching, monitoring)\n- No built-in auto-scaling\n- Requires more infrastructure knowledge\n\n**Exception:**\n- PostgreSQL will use Azure Flexible Server (PaaS) for practical reasons (managed backups, HA)\n",
          "date" : "2025-12-15T00:00:00Z",
          "format" : "Markdown",
          "id" : "1",
          "status" : "Accepted",
          "title" : "Use Pure IaaS Approach"
        }, {
          "content" : "# 2. Use Python Flask for Web Application\n\nDate: 2025-12-15\n\n## Status\n\nAccepted\n\n## Context\n\nWe need to select a web framework for the registration application.\n\nOptions considered:\n1. Python Flask\n2. Python Django\n3. Node.js Express\n4. Go with Gin\n\n## Decision\n\nWe will use Python Flask with:\n- Jinja2 for server-side templating\n- SQLAlchemy for database ORM\n- Gunicorn as WSGI production server\n\n## Consequences\n\n**Positive:**\n- Lightweight and simple to understand\n- Excellent documentation and community\n- Easy to deploy on Linux VMs\n- Good integration with PostgreSQL via psycopg2\n\n**Negative:**\n- Synchronous by default (acceptable for expected load)\n- Less built-in features than Django (acceptable for simple app)\n",
          "date" : "2025-12-15T00:00:00Z",
          "format" : "Markdown",
          "id" : "2",
          "status" : "Accepted",
          "title" : "Use Python Flask for Web Application"
        }, {
          "content" : "# 3. Use Bastion Host for SSH Access\n\nDate: 2025-12-15\n\n## Status\n\nAccepted\n\n## Context\n\nWe need secure administrative access to internal VMs without exposing them directly to the internet.\n\nOptions considered:\n1. Direct SSH access to all VMs (public IPs)\n2. VPN gateway\n3. Azure Bastion service (PaaS)\n4. Self-managed bastion host (jump server)\n\n## Decision\n\nWe will use a self-managed bastion host (Ubuntu VM) as an SSH jump server.\n\n## Consequences\n\n**Positive:**\n- Only one public SSH endpoint exposed\n- Internal VMs have no public IPs (reduced attack surface)\n- Full control over bastion configuration\n- Consistent with IaaS approach\n\n**Negative:**\n- Additional VM to maintain\n- Single point of failure for admin access\n- Requires SSH key management\n",
          "date" : "2025-12-15T00:00:00Z",
          "format" : "Markdown",
          "id" : "3",
          "status" : "Accepted",
          "title" : "Use Bastion Host for SSH Access"
        } ],
        "sections" : [ {
          "content" : "# Webinar Registration Website\n\n## Overview\n\nThe Webinar Registration Website is a web application that allows event attendees to register for webinars and marketing administrators to view registrations.\n\nThis documentation accompanies the C4 architecture model and provides detailed explanations of each architectural level.\n\n### Key Features\n\n- **Registration Form**: Public-facing form for webinar signup\n- **Registration List**: Admin view of all registrations\n- **Health Endpoint**: System monitoring capability (`/health`)\n\n### Technology Stack\n\n| Layer | Technology |\n|-------|------------|\n| Frontend | Server-side rendered HTML (Jinja2) |\n| Backend | Python Flask 3.0+ with Gunicorn WSGI |\n| Database | PostgreSQL 16 (Azure Flexible Server) |\n| Web Server | nginx reverse proxy with SSL |\n| Infrastructure | Azure IaaS (Virtual Machines) |\n| IaC | Bicep (declarative) |\n\n### Architecture Levels\n\nThis documentation follows the [C4 model](https://c4model.com/) for visualizing software architecture:\n\n| Level | View | Description |\n|-------|------|-------------|\n| **C1** | System Context | Actors and the system boundary |\n| **C2** | Containers | Technical building blocks (VMs, databases) |\n| **C3** | Components | Internal structure of the Flask application |\n| **Deployment** | Infrastructure | Azure IaaS deployment topology |\n\n### Quick Links\n\n- [System Context (C1)](02-context.md) - Who uses the system?\n- [Containers (C2)](03-containers.md) - What are the main technical components?\n- [Components (C3)](04-components.md) - How does the Flask app work internally?\n- [Deployment](05-deployment.md) - How is it deployed on Azure?\n\n### Architecture Decisions\n\nKey architectural decisions are documented in the ADRs (Architecture Decision Records):\n\n- **ADR-0001**: Use Pure IaaS Approach\n- **ADR-0002**: Use Python Flask for Web Application\n- **ADR-0003**: Use Bastion Host for SSH Access\n\n### Source Code\n\n| Component | Location |\n|-----------|----------|\n| Infrastructure (Bicep) | `infrastructure/` |\n| Flask Application | `application/` |\n| Deployment Scripts | `deploy/` |\n| Cloud-init configs | `infrastructure/cloud-init/` |\n",
          "filename" : "01-overview.md",
          "format" : "Markdown",
          "order" : 1,
          "title" : ""
        }, {
          "content" : "# System Context (C1)\n\n## System Context (C4 Model Level 1)\n\nThis document provides the highest level view of the Webinar Registration Website system, showing how it fits into the broader environment of users and external systems.\n\n### System Context Diagram\n\n![](embed:C1-Context)\n\n### Context Description\n\n#### The System\n\n**Webinar Registration Website** is a web application that:\n\n- Provides a public-facing registration form for upcoming webinars\n- Stores registration data persistently\n- Allows marketing staff to view who has registered\n- Runs entirely on Azure infrastructure (IaaS approach)\n- Includes the web frontend (HTML/CSS/JS rendered in user's browser)\n\n#### Users (Actors)\n\n| Actor | Description | Interaction |\n|-------|-------------|-------------|\n| **Event Attendee** | External users (potential customers, partners) who discover the webinar through marketing channels | Register for webinars via browser (HTTPS) |\n| **Marketing Administrator** | Internal staff responsible for managing webinar events | View registration lists via browser (HTTPS) |\n| **System Administrator** | IT operations staff responsible for infrastructure | Deploy, configure, and maintain via terminal (SSH) |\n\n### Key Architectural Decisions\n\n1. **Pure IaaS Approach**: Traditional infrastructure model using self-managed VMs on Azure\n2. **Python Flask**: Lightweight web framework with Jinja2 templating (SSR) and SQLAlchemy ORM\n3. **PostgreSQL**: Robust open-source relational database, available as PaaS on Azure (Flexible Server)\n4. **SSL/TLS Encryption**: Self-signed certificates for learning environment (Let's Encrypt recommended for production)\n5. **No External Identity Provider**: Simple application without authentication requirements for attendee registration\n\n### Quality Attributes\n\nFrom the PRD, the key non-functional requirements affecting architecture:\n\n| Attribute | Requirement | Impact |\n|-----------|-------------|--------|\n| **Availability** | >=99% uptime during business hours | Single VM design acceptable for MVP |\n| **Response Time** | Pages load < 3 seconds on broadband | Nginx caching, optimized queries |\n| **Capacity** | Support 100 concurrent users | Single app server sufficient |\n| **Security** | HTTPS only, OWASP guidelines | SSL termination at proxy, bastion host for SSH access, private subnets for app/data tiers, NSGs restricting traffic flow |\n\n### Scope Boundary\n\n#### In Scope\n\n- Registration form and data persistence\n- Admin view of registrations\n- HTTPS encryption\n- Basic health monitoring\n\n#### Out of Scope (for this stage)\n\n- User authentication/authorization\n- Email notifications\n- Payment processing\n- Multi-region deployment\n- Auto-scaling\n\n### Next Level\n\nSee [Containers (C2)](03-containers.md) for the technical building blocks that make up this system.\n",
          "filename" : "02-context.md",
          "format" : "Markdown",
          "order" : 2,
          "title" : ""
        }, {
          "content" : "# Containers (C2)\n\n## Containers (C4 Model Level 2)\n\nThis document zooms into the Webinar Registration Website system to show the high-level technical building blocks (containers) and how they interact.\n\n> **C4 \"Container\"** = A separately deployable/runnable unit (VM, application, database), NOT a Docker container.\n\n### Container Diagram\n\n![](embed:C2-Containers-Full)\n\n### Container Inventory\n\n#### Compute Containers\n\n| Container | Technology | Purpose | Network Location |\n|-----------|------------|---------|------------------|\n| **Bastion Host** | Ubuntu 24.04 LTS | Secure SSH entry point; no direct access to app servers from internet | `snet-bastion` (10.0.1.0/24), Public IP |\n| **Reverse Proxy** | nginx on Ubuntu 24.04 | SSL termination, load balancing (future), security headers | `snet-web` (10.0.2.0/24), Public IP |\n| **Flask Application** | Python 3 + Gunicorn on Ubuntu 24.04 | Business logic, HTML rendering, REST endpoints | `snet-app` (10.0.3.0/24), Private only |\n| **PostgreSQL Database** | Azure PostgreSQL Flexible Server | Persistent data storage | `snet-data` (10.0.4.0/24), Private endpoint |\n\n#### Supporting Infrastructure\n\n| Component | Purpose |\n|-----------|---------|\n| **Virtual Network** | `vnet-flask-bicep-dev` (10.0.0.0/16) - Network isolation |\n| **NSGs** | Network Security Groups per subnet controlling traffic flow |\n| **ASGs** | Application Security Groups for role-based rules |\n\n### Network Flow\n\n#### User Traffic (Registration)\n\n```\nInternet -> Public IP (pip-proxy) -> nginx:443 -> vm-app:5001 -> PostgreSQL:5432\n```\n\n#### Administrative Access\n\n```\nInternet -> Public IP (pip-bastion) -> vm-bastion:22 -> (SSH tunnel) -> vm-proxy/vm-app:22\n```\n\n#### Security Boundaries\n\n```\n+-------------------------------------------------------------------------+\n|  INTERNET                                                                |\n+------+-------------------------------------------+----------------------+\n       | SSH:22                                    | HTTPS:443\n       v                                           v\n+--------------+                          +--------------+\n| vm-bastion   |                          | vm-proxy     |\n| (jump host)  |                          | (nginx)      |\n+------+-------+                          +------+-------+\n       | SSH:22 (internal)                       | HTTP:5001\n       v                                         v\n+------------------------------------------------------------------------+\n|  PRIVATE NETWORK                                                        |\n|  +--------------+                          +--------------------------+ |\n|  | vm-app       |-----PostgreSQL:5432----->| PostgreSQL Flex Server   | |\n|  | (Flask)      |                          | (Azure PaaS)             | |\n|  +--------------+                          +--------------------------+ |\n+------------------------------------------------------------------------+\n```\n\n### Container Details\n\n#### 1. Bastion Host (`vm-bastion`)\n\n**Purpose**: Secure administrative access without exposing internal VMs\n\n| Aspect | Detail |\n|--------|--------|\n| Image | Ubuntu 24.04 LTS |\n| Size | Standard_B1s (1 vCPU, 1GB RAM) |\n| Public IP | Yes (`pip-bastion`) |\n| Inbound Rules | SSH (22) from Internet |\n| Outbound Rules | SSH (22) to internal VMs |\n| Security | Fail2ban (3 strikes, 1 hour ban) |\n\n#### 2. Reverse Proxy (`vm-proxy`)\n\n**Purpose**: SSL termination, public endpoint, future load balancing\n\n| Aspect | Detail |\n|--------|--------|\n| Image | Ubuntu 24.04 LTS |\n| Size | Standard_B1s |\n| Public IP | Yes (`pip-proxy`) |\n| Software | nginx |\n| SSL | Self-signed certificate (CN=flask-app) |\n| Inbound Rules | HTTPS (443), HTTP (80 -> redirect) |\n| Outbound Rules | HTTP (5001) to app subnet |\n\n**nginx Configuration**:\n\n- HTTP -> HTTPS redirect (301)\n- SSL with TLS 1.2/1.3 only\n- Proxy headers (X-Real-IP, X-Forwarded-For, X-Forwarded-Proto)\n- Upstream: `http://vm-app:5001`\n\n#### 3. Flask Application (`vm-app`)\n\n**Purpose**: Core application logic and data access\n\n| Aspect | Detail |\n|--------|--------|\n| Image | Ubuntu 24.04 LTS |\n| Size | Standard_B1s |\n| Public IP | **No** (security: internal only) |\n| Runtime | Python 3 + Gunicorn WSGI server |\n| Binding | `0.0.0.0:5001` |\n| Service User | `flask-app` (system user, no login shell) |\n| Inbound Rules | HTTP (5001) from web subnet only |\n\n**Key Files on VM**:\n\n```\n/opt/flask-app/           # Application code\n/opt/flask-app/venv/      # Python virtual environment\n/etc/flask-app/app.env    # DATABASE_URL (chmod 640, root:flask-app)\n/etc/systemd/system/flask-app.service\n```\n\n#### 4. PostgreSQL Database\n\n**Purpose**: Persistent storage for registration data\n\n| Aspect | Detail |\n|--------|--------|\n| Service | Azure Database for PostgreSQL Flexible Server |\n| SKU | Burstable B1ms (1 vCPU, 2GB) |\n| Version | PostgreSQL 16 |\n| Access | Private endpoint in `snet-data` |\n| Database | `flask` |\n| SSL | Required (`sslmode=require`) |\n\n> **Note**: This is the only PaaS component. We use managed PostgreSQL for practical reasons (backups, HA, patching) while keeping compute as IaaS for learning purposes.\n\n### Technology Choices\n\n| Decision | Choice | Rationale |\n|----------|--------|-----------|\n| Web Server | nginx | Industry standard, excellent reverse proxy, low resource usage |\n| WSGI Server | Gunicorn | Production-grade, simple configuration, works well with Flask |\n| Database | PostgreSQL | Robust, open source, excellent Python support (psycopg2) |\n| Process Manager | systemd | Standard on modern Ubuntu, automatic restarts, logging |\n| Infrastructure | Azure Bicep | Declarative IaC, native Azure support, good learning value |\n\n### Deployment Pipeline\n\n```\n+-------------+    +-------------+    +-------------+\n| provision.sh|--->|cloud-init   |--->| deploy.sh   |\n| (Bicep)     |    |(VMs boot)   |    |(App code)   |\n+-------------+    +-------------+    +-------------+\n     |                   |                   |\n     v                   v                   v\n - VNet, Subnets     - Install nginx     - Copy app files\n - NSGs, ASGs        - Install Python    - Install deps\n - VMs               - Create users      - Configure DB URL\n - PostgreSQL        - Systemd units     - Start service\n```\n\n### Next Level\n\nSee [Components (C3)](04-components.md) for the internal structure of the Flask application.\n",
          "filename" : "03-containers.md",
          "format" : "Markdown",
          "order" : 3,
          "title" : ""
        }, {
          "content" : "# Components (C3)\n\n## Components (C4 Model Level 3)\n\nThis document zooms into the Flask Application container to show its internal structure and how components collaborate to fulfill the system's responsibilities.\n\n> **Note**: For a simple Flask application like this one, a component diagram may be more detailed than strictly necessary. We include it here for educational completeness.\n\n### Flask Application Components\n\n![](embed:C3-Components)\n\n### Reverse Proxy Components\n\nThe nginx reverse proxy also has internal components worth understanding:\n\n![](embed:C3-Components-Proxy)\n\n### Component Inventory\n\n#### Application Components\n\n| Component | Technology | Responsibility | Source |\n|-----------|------------|----------------|--------|\n| **Route Handlers** | Flask routes | Handle HTTP requests, process forms, return responses | `app.py` |\n| **Template Engine** | Jinja2 | Render dynamic HTML pages | Inline in `app.py` |\n| **Data Models** | SQLAlchemy | Object-relational mapping, database schema | `app.py` (Entry class) |\n| **WSGI Server** | Gunicorn | Production HTTP server, worker processes | `wsgi.py` |\n\n### Component Details\n\n#### 1. Route Handlers\n\nThe application exposes three HTTP endpoints:\n\n| Route | Method | Purpose | Response |\n|-------|--------|---------|----------|\n| `/` | GET | Display registration form + recent entries | HTML page |\n| `/` | POST | Process new registration | Redirect to GET `/` |\n| `/entries` | GET | List all entries as JSON | JSON array |\n| `/health` | GET | Health check for monitoring | `{\"status\": \"ok\"}` |\n\n**Code Structure** (`application/app.py`):\n\n```python\n@app.route('/', methods=['GET', 'POST'])\ndef index():\n    # POST: Create new entry\n    # GET: Render form with recent entries\n\n@app.route('/entries')\ndef list_entries():\n    # Return all entries as JSON\n\n@app.route('/health')\ndef health():\n    # Health check endpoint\n```\n\n#### 2. Template Engine\n\nUses Jinja2 (Flask's default) with inline template definition:\n\n**Template Variables**:\n\n| Variable | Source | Purpose |\n|----------|--------|---------|\n| `entries` | Query result | List of recent Entry objects |\n| `count` | `Entry.query.count()` | Total number of registrations |\n| `db_type` | Environment check | Shows \"PostgreSQL\" or \"SQLite\" |\n\n**Template Features Used**:\n\n- `{% for entry in entries %}` - Iteration\n- `{{ entry.value }}` - Variable interpolation\n- `{{ entry.created_at.strftime() }}` - Method calls\n- `{% else %}` - Empty state handling\n\n#### 3. Data Models\n\nSingle model representing a registration entry:\n\n```python\nclass Entry(db.Model):\n    __tablename__ = 'entries'\n\n    id = db.Column(db.Integer, primary_key=True)\n    value = db.Column(db.Text, nullable=False)     # Registrant info\n    created_at = db.Column(db.DateTime, default=datetime.utcnow)\n```\n\n**Database Operations**:\n\n| Operation | Code Pattern | SQL Equivalent |\n|-----------|--------------|----------------|\n| Create | `db.session.add(entry)` | INSERT INTO entries... |\n| Read all | `Entry.query.all()` | SELECT * FROM entries |\n| Read recent | `Entry.query.order_by(...).limit(10)` | SELECT ... ORDER BY ... LIMIT 10 |\n| Count | `Entry.query.count()` | SELECT COUNT(*) FROM entries |\n\n#### 4. WSGI Server\n\n**Entry Point** (`application/wsgi.py`):\n\n```python\nfrom app import app\n\nif __name__ == '__main__':\n    app.run()\n```\n\n**Gunicorn Configuration** (via systemd unit):\n\n```bash\ngunicorn --bind 0.0.0.0:5001 wsgi:app\n```\n\n| Setting | Value | Purpose |\n|---------|-------|---------|\n| `--bind` | `0.0.0.0:5001` | Listen on all interfaces, port 5001 |\n| Workers | 1 (default) | Single worker sufficient for small load |\n| Module | `wsgi:app` | Import `app` object from `wsgi.py` |\n\n### Data Flow\n\n#### Registration Flow (Happy Path)\n\n```\n1. User submits form\n   POST / {value: \"John Doe\"}\n        |\n        v\n2. Route handler receives request\n   @app.route('/', methods=['POST'])\n        |\n        v\n3. Create Entry object\n   entry = Entry(value=\"John Doe\")\n        |\n        v\n4. Persist to database\n   db.session.add(entry)\n   db.session.commit()\n        |\n        v\n5. Redirect to GET /\n   return redirect(url_for('index'))\n        |\n        v\n6. Query recent entries\n   Entry.query.order_by(created_at.desc()).limit(10)\n        |\n        v\n7. Render template with data\n   render_template_string(INDEX_TEMPLATE, entries=entries, ...)\n        |\n        v\n8. Return HTML to user\n```\n\n#### Request/Response Cycle\n\n```\n+---------+     +---------+     +---------+     +---------+\n| Browser |---->| nginx   |---->|Gunicorn |---->| Flask   |\n+---------+     +---------+     +---------+     +---------+\n                                                     |\n                    +--------------------------------+\n                    v\n              +---------+     +---------+\n              | Model   |---->|PostgreSQL|\n              +---------+     +---------+\n```\n\n### Dependencies\n\n#### Python Packages (`application/requirements.txt`)\n\n| Package | Purpose |\n|---------|---------|\n| `Flask` | Web framework |\n| `Flask-SQLAlchemy` | ORM integration |\n| `gunicorn` | Production WSGI server |\n| `psycopg2-binary` | PostgreSQL driver |\n\n#### External Dependencies\n\n| Dependency | Source | Purpose |\n|------------|--------|---------|\n| `DATABASE_URL` | `/etc/flask-app/app.env` | PostgreSQL connection string |\n| PostgreSQL | Azure PaaS | Data persistence |\n| nginx | vm-proxy | Reverse proxy, SSL |\n\n### Future Evolution\n\nFor a production-ready application, this simple structure would evolve:\n\n| Current | Production Evolution |\n|---------|---------------------|\n| Inline templates | Separate `templates/` directory |\n| Single `app.py` | Blueprint-based modular structure |\n| Inline models | Separate `models.py` |\n| No validation | Form validation (WTForms) |\n| No auth | Flask-Login + session management |\n| Single model | Multiple models with relationships |\n\n### Next Level\n\nSee [Deployment](05-deployment.md) for how this system is deployed on Azure infrastructure.\n",
          "filename" : "04-components.md",
          "format" : "Markdown",
          "order" : 4,
          "title" : ""
        }, {
          "content" : "# Deployment\n\n## Azure IaaS Deployment Architecture\n\nThis document shows how the Webinar Registration Website is deployed on Azure infrastructure using a pure IaaS approach.\n\n### Deployment Diagram\n\n![](embed:Deployment)\n\n### Infrastructure Overview\n\n#### Network Topology\n\n| Subnet | CIDR | NSG | Purpose |\n|--------|------|-----|---------|\n| `snet-bastion` | 10.0.1.0/24 | `nsg-bastion` | SSH jump host (public access) |\n| `snet-web` | 10.0.2.0/24 | `nsg-web` | Reverse proxy (public access) |\n| `snet-app` | 10.0.3.0/24 | `nsg-app` | Application server (internal only) |\n| `snet-data` | 10.0.4.0/24 | `nsg-data` | PostgreSQL database (internal only) |\n\n#### Virtual Machines\n\n| VM | Subnet | Public IP | Size | Purpose |\n|----|--------|-----------|------|---------|\n| `vm-bastion` | snet-bastion | Yes | Standard_B1s | SSH jump server |\n| `vm-proxy` | snet-web | Yes | Standard_B1s | nginx reverse proxy |\n| `vm-app` | snet-app | No | Standard_B1s | Flask application |\n\n#### Managed Services\n\n| Service | SKU | Purpose |\n|---------|-----|---------|\n| PostgreSQL Flexible Server | Burstable B1ms | Database (the only PaaS component) |\n\n### Security Architecture\n\n#### Network Security Groups (NSGs)\n\nEach subnet has an NSG controlling inbound/outbound traffic:\n\n**nsg-bastion**:\n- Allow SSH (22) from Internet\n- Deny all other inbound\n\n**nsg-web**:\n- Allow HTTP (80) from Internet\n- Allow HTTPS (443) from Internet\n- Allow SSH (22) from asg-bastion\n- Deny all other inbound\n\n**nsg-app**:\n- Allow HTTP (5001) from asg-proxy\n- Allow SSH (22) from asg-bastion\n- Deny all other inbound\n\n**nsg-data**:\n- Allow PostgreSQL (5432) from snet-app\n- Deny all other inbound\n\n#### Application Security Groups (ASGs)\n\nASGs provide role-based security rules:\n\n| ASG | Members | Purpose |\n|-----|---------|---------|\n| `asg-bastion` | vm-bastion | Source for SSH to internal VMs |\n| `asg-proxy` | vm-proxy | Source for HTTP to app server |\n| `asg-app` | vm-app | Target for application traffic |\n\n### Deployment Process\n\n#### Infrastructure Provisioning\n\n```bash\n# One-command deployment\n./deploy-all.sh\n\n# Or step-by-step:\n./infrastructure/provision.sh      # Deploy Bicep (15-20 min)\n./scripts/wait-for-postgresql.sh   # Wait for DB ready\n./scripts/wait-for-vms-cloud-init.sh  # Wait for VMs configured\n./deploy/deploy.sh                 # Deploy application\n./scripts/verification-tests.sh    # Run tests\n```\n\n#### Cloud-init Configuration\n\nEach VM is configured automatically via cloud-init:\n\n| VM | Cloud-init | Key Configuration |\n|----|------------|-------------------|\n| vm-bastion | `bastion.yaml` | fail2ban, SSH hardening |\n| vm-proxy | `proxy.yaml` | nginx, self-signed SSL cert |\n| vm-app | `app.yaml` | Python venv, systemd service, flask-app user |\n\n#### Application Deployment\n\nThe Flask application is deployed via SSH through the bastion:\n\n```\n1. SCP files to vm-app via bastion jump\n2. Install Python dependencies in virtualenv\n3. Configure DATABASE_URL in /etc/flask-app/app.env\n4. Start flask-app systemd service\n```\n\n### Cost Estimate\n\n| Resource | SKU | Monthly Cost |\n|----------|-----|--------------|\n| 3x VMs | Standard_B1s | ~$21 ($7 each) |\n| PostgreSQL | Burstable B1ms | ~$12 |\n| Public IPs | 2x Static | ~$8 |\n| Storage | 3x 30GB | ~$3 |\n| **Total** | | **~$44/month** |\n\n### Naming Conventions\n\nFollowing Azure Cloud Adoption Framework (CAF):\n\n| Resource Type | Pattern | Example |\n|---------------|---------|---------|\n| Resource Group | `rg-{project}-{env}` | `rg-flask-bicep-dev` |\n| Virtual Network | `vnet-{project}-{env}` | `vnet-flask-bicep-dev` |\n| Subnet | `snet-{tier}` | `snet-bastion` |\n| NSG | `nsg-{tier}` | `nsg-web` |\n| VM | `vm-{role}` | `vm-proxy` |\n| PostgreSQL | `psql-{project}-{env}` | `psql-flask-bicep-dev` |\n\n### Infrastructure as Code\n\nAll infrastructure is defined in Bicep:\n\n```\ninfrastructure/\n main.bicep              # Entry point\n modules/\n     network.bicep       # VNet, subnets, NSGs, ASGs\n     bastion.bicep       # Jump host VM\n     proxy.bicep         # Reverse proxy VM\n     app.bicep           # Application VM\n     database.bicep      # PostgreSQL + private DNS\n```\n\n### Related Documentation\n\n- [Overview](01-overview.md) - Project overview\n- [System Context](02-context.md) - C1 diagram\n- [Containers](03-containers.md) - C2 diagram\n- [Components](04-components.md) - C3 diagram\n",
          "filename" : "05-deployment.md",
          "format" : "Markdown",
          "order" : 5,
          "title" : ""
        } ]
      },
      "id" : "4",
      "name" : "Webinar Registration Website",
      "properties" : {
        "structurizr.dsl.identifier" : "webinarSystem"
      },
      "tags" : "Element,Software System"
    } ]
  },
  "name" : "Webinar Registration Website",
  "properties" : {
    "structurizr.inspection.error" : "4",
    "structurizr.inspection.info" : "0",
    "structurizr.inspection.ignore" : "0",
    "structurizr.inspection.warning" : "0"
  },
  "views" : {
    "componentViews" : [ {
      "containerId" : "12",
      "description" : "Component diagram showing Flask application internals",
      "dimensions" : {
        "height" : 1463,
        "width" : 5422
      },
      "elements" : [ {
        "id" : "1",
        "x" : 200,
        "y" : 164
      }, {
        "id" : "5",
        "x" : 972,
        "y" : 212
      }, {
        "id" : "8",
        "x" : 1727,
        "y" : 202
      }, {
        "id" : "13",
        "x" : 3177,
        "y" : 187
      }, {
        "id" : "14",
        "x" : 3162,
        "y" : 707
      }, {
        "id" : "15",
        "x" : 3962,
        "y" : 182
      }, {
        "id" : "16",
        "x" : 2462,
        "y" : 187
      }, {
        "id" : "17",
        "x" : 4752,
        "y" : 172
      } ],
      "externalContainerBoundariesVisible" : false,
      "key" : "C3-Components",
      "name" : "Component View: Webinar Registration Website - Flask Application",
      "order" : 3,
      "relationships" : [ {
        "id" : "21"
      }, {
        "id" : "24",
        "vertices" : [ {
          "x" : 1576,
          "y" : 506
        } ]
      }, {
        "id" : "30"
      }, {
        "id" : "31"
      }, {
        "id" : "32"
      }, {
        "id" : "33"
      }, {
        "id" : "34"
      }, {
        "id" : "35",
        "vertices" : [ {
          "x" : 1200,
          "y" : 854
        } ]
      }, {
        "id" : "39"
      } ]
    }, {
      "containerId" : "8",
      "description" : "Component diagram showing nginx internals",
      "dimensions" : {
        "height" : 2148,
        "width" : 4725
      },
      "elements" : [ {
        "id" : "1",
        "x" : 200,
        "y" : 142
      }, {
        "id" : "5",
        "x" : 1025,
        "y" : 212
      }, {
        "id" : "9",
        "x" : 2075,
        "y" : 212
      }, {
        "id" : "10",
        "x" : 2075,
        "y" : 787
      }, {
        "id" : "11",
        "x" : 2195,
        "y" : 1392
      }, {
        "id" : "12",
        "x" : 3120,
        "y" : 777
      }, {
        "id" : "17",
        "x" : 4055,
        "y" : 782
      } ],
      "externalContainerBoundariesVisible" : false,
      "key" : "C3-Components-Proxy",
      "name" : "Component View: Webinar Registration Website - Reverse Proxy",
      "order" : 4,
      "relationships" : [ {
        "id" : "21"
      }, {
        "id" : "29"
      }, {
        "id" : "37"
      }, {
        "id" : "38",
        "vertices" : [ {
          "x" : 1960,
          "y" : 467
        }, {
          "x" : 1565,
          "y" : 467
        } ]
      }, {
        "id" : "40"
      }, {
        "id" : "41"
      }, {
        "id" : "42"
      } ]
    } ],
    "configuration" : {
      "branding" : { },
      "lastSavedView" : "C1-Context",
      "styles" : {
        "elements" : [ {
          "background" : "#999999",
          "color" : "#ffffff",
          "tag" : "Bastion"
        }, {
          "background" : "#85bbf0",
          "color" : "#000000",
          "shape" : "RoundedBox",
          "tag" : "Client"
        }, {
          "background" : "#85bbf0",
          "color" : "#000000",
          "tag" : "Component"
        }, {
          "background" : "#438dd5",
          "color" : "#ffffff",
          "tag" : "Container"
        }, {
          "background" : "#438dd5",
          "color" : "#ffffff",
          "shape" : "Cylinder",
          "tag" : "Database"
        }, {
          "background" : "#ffffff",
          "color" : "#cc0000",
          "tag" : "NSG"
        }, {
          "background" : "#08427b",
          "color" : "#ffffff",
          "shape" : "Person",
          "tag" : "Person"
        }, {
          "background" : "#08427b",
          "color" : "#ffffff",
          "tag" : "Primary Actor"
        }, {
          "background" : "#08427b",
          "color" : "#ffffff",
          "shape" : "RoundedBox",
          "tag" : "Primary Client"
        }, {
          "background" : "#5c5c5c",
          "color" : "#ffffff",
          "tag" : "Secondary Actor"
        }, {
          "background" : "#5c5c5c",
          "color" : "#ffffff",
          "shape" : "RoundedBox",
          "tag" : "Secondary Client"
        }, {
          "background" : "#438dd5",
          "color" : "#ffffff",
          "tag" : "Software System"
        }, {
          "background" : "#85bbf0",
          "color" : "#000000",
          "tag" : "Tertiary Actor"
        } ]
      },
      "terminology" : { },
      "themes" : [ "https://static.structurizr.com/themes/default/theme.json" ]
    },
    "containerViews" : [ {
      "description" : "Container diagram showing the complete system",
      "dimensions" : {
        "height" : 1902,
        "width" : 3790
      },
      "elements" : [ {
        "id" : "1",
        "x" : 199,
        "y" : 572
      }, {
        "id" : "2",
        "x" : 204,
        "y" : 142
      }, {
        "id" : "3",
        "x" : 209,
        "y" : 1102
      }, {
        "id" : "5",
        "x" : 934,
        "y" : 622
      }, {
        "id" : "6",
        "x" : 944,
        "y" : 1152
      }, {
        "id" : "7",
        "x" : 1684,
        "y" : 1162
      }, {
        "id" : "8",
        "x" : 1684,
        "y" : 622
      }, {
        "id" : "12",
        "x" : 2374,
        "y" : 617
      }, {
        "id" : "17",
        "x" : 3099,
        "y" : 617
      } ],
      "externalSoftwareSystemBoundariesVisible" : false,
      "key" : "C2-Containers-Full",
      "name" : "Container View: Webinar Registration Website",
      "order" : 2,
      "relationships" : [ {
        "id" : "21"
      }, {
        "id" : "22"
      }, {
        "id" : "23"
      }, {
        "id" : "24"
      }, {
        "id" : "25"
      }, {
        "id" : "26"
      }, {
        "id" : "27"
      }, {
        "id" : "28"
      }, {
        "id" : "29"
      } ],
      "softwareSystemId" : "4"
    } ],
    "deploymentViews" : [ {
      "description" : "Azure IaaS deployment architecture",
      "dimensions" : {
        "height" : 3136,
        "width" : 4792
      },
      "elements" : [ {
        "id" : "43",
        "x" : 175,
        "y" : 175
      }, {
        "id" : "44",
        "x" : 175,
        "y" : 175
      }, {
        "id" : "45",
        "x" : 100,
        "y" : 1095
      }, {
        "id" : "46",
        "x" : 0,
        "y" : 0
      }, {
        "id" : "47",
        "x" : 100,
        "y" : 2050
      }, {
        "id" : "48",
        "x" : 175,
        "y" : 175
      }, {
        "id" : "49",
        "x" : 175,
        "y" : 175
      }, {
        "id" : "50",
        "x" : 175,
        "y" : 175
      }, {
        "id" : "51",
        "x" : 950,
        "y" : 1728
      }, {
        "id" : "52",
        "x" : 175,
        "y" : 175
      }, {
        "id" : "53",
        "x" : 1455,
        "y" : 2048
      }, {
        "id" : "55",
        "x" : 175,
        "y" : 175
      }, {
        "id" : "56",
        "x" : 960,
        "y" : 776
      }, {
        "id" : "57",
        "x" : 175,
        "y" : 175
      }, {
        "id" : "58",
        "x" : 1460,
        "y" : 1091
      }, {
        "id" : "62",
        "x" : 175,
        "y" : 175
      }, {
        "id" : "63",
        "x" : 2170,
        "y" : 771
      }, {
        "id" : "64",
        "x" : 175,
        "y" : 175
      }, {
        "id" : "65",
        "x" : 2675,
        "y" : 1091
      }, {
        "id" : "69",
        "x" : 175,
        "y" : 175
      }, {
        "id" : "70",
        "x" : 3365,
        "y" : 768
      }, {
        "id" : "71",
        "x" : 175,
        "y" : 175
      }, {
        "id" : "72",
        "x" : 3890,
        "y" : 1091
      } ],
      "environment" : "Production",
      "key" : "Deployment",
      "name" : "Deployment View: Webinar Registration Website - Production",
      "order" : 5,
      "relationships" : [ {
        "id" : "54"
      }, {
        "id" : "60"
      }, {
        "id" : "61"
      }, {
        "id" : "67",
        "vertices" : [ {
          "x" : 2895,
          "y" : 2193
        } ]
      }, {
        "id" : "68"
      }, {
        "id" : "73"
      } ],
      "softwareSystemId" : "4"
    } ],
    "systemContextViews" : [ {
      "automaticLayout" : {
        "applied" : false,
        "edgeSeparation" : 0,
        "implementation" : "Graphviz",
        "nodeSeparation" : 300,
        "rankDirection" : "LeftRight",
        "rankSeparation" : 300,
        "vertices" : false
      },
      "description" : "System Context diagram showing actors and the system",
      "elements" : [ {
        "id" : "1",
        "x" : 0,
        "y" : 0
      }, {
        "id" : "2",
        "x" : 0,
        "y" : 0
      }, {
        "id" : "3",
        "x" : 0,
        "y" : 0
      }, {
        "id" : "4",
        "x" : 0,
        "y" : 0
      } ],
      "enterpriseBoundaryVisible" : true,
      "key" : "C1-Context",
      "name" : "System Context View: Webinar Registration Website",
      "order" : 1,
      "relationships" : [ {
        "id" : "18"
      }, {
        "id" : "19"
      }, {
        "id" : "20"
      } ],
      "softwareSystemId" : "4"
    } ]
  }
}